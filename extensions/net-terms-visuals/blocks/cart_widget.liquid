{% if customer.tags contains 'Net30_Approved' %}
  <script src="https://cdn.tailwindcss.com"></script>
  
  <div class="page-width" style="margin-top: 20px; margin-bottom: 20px;">
    {% assign limit = customer.metafields.net_terms.credit_limit | default: 0 %}
    {% assign spend = cart.total_price | divided_by: 100.0 %}
    {% assign available = limit | minus: spend %}
    {% assign width = spend | divided_by: limit | times: 100 %}

    <div class="bg-white border border-slate-200 rounded-lg shadow-sm p-4">
      <div class="flex items-center justify-between mb-3">
        <div class="flex items-center gap-2">
          <div class="bg-emerald-100 text-emerald-700 p-1.5 rounded-full">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          </div>
          <div>
            <h3 class="font-bold text-slate-800 text-sm">Net 30 Account Active</h3>
            <p class="text-xs text-slate-500">Authorized for {{ shop.name }}</p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-xs text-slate-500 uppercase tracking-wider font-semibold">Credit Limit</p>
          <p class="font-mono text-lg font-bold text-emerald-600">${{ limit | money_without_currency }}</p>
        </div>
      </div>

      <div class="w-full bg-slate-100 rounded-full h-2.5 mb-1">
        <div class="bg-emerald-500 h-2.5 rounded-full transition-all duration-500" style="width: {{ width }}%"></div>
      </div>
      
      <div class="flex justify-between text-xs font-medium mt-2">
        <span class="text-slate-600">Current Order: {{ cart.total_price | money }}</span>
        <span class="text-emerald-700">Remaining: ${{ available | money_without_currency }}</span>
      </div>
    </div>
  </div>
{% endif %}

{% schema %}
{
  "name": "Net Terms Banner",
  "target": "section",
  "settings": []
}
{% endschema %}